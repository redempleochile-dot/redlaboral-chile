<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Directorio de Talentos | EmpleosChile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    {% load humanize %}
    <style>.hover-card { transition: transform 0.2s; } .hover-card:hover { transform: translateY(-5px); }</style>
</head>
<body class="bg-light">

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
        <div class="container">
            <a class="navbar-brand fw-bold" href="/">üá®üá± EmpleosChile</a>
            <div class="d-flex"><a href="/publicar-perfil/" class="btn btn-warning fw-bold">üì¢ Publicar mi Perfil</a></div>
        </div>
    </nav>

    <div class="container mb-5">
        <h2 class="fw-bold mb-4 text-center">Talento Disponible en Chile üá®üá±</h2>
        
        <div class="row">
            <div class="col-md-3 mb-4">
                <div class="card shadow-sm border-0 sticky-top" style="top: 20px;">
                    <div class="card-header bg-white fw-bold">üîç Filtrar Talentos</div>
                    <div class="card-body">
                        <form method="get">
                            <label class="small text-muted mb-1">√Årea / Rubro</label>
                            <select name="rubro" class="form-select mb-3">
                                <option value="">Todas las √°reas</option>
                                {% for codigo, nombre in rubros %}
                                    <option value="{{ codigo }}" {% if request.GET.rubro == codigo %}selected{% endif %}>{{ nombre }}</option>
                                {% endfor %}
                            </select>
                            <label class="small text-muted mb-1">Regi√≥n</label>
                            <select name="region" class="form-select mb-3">
                                <option value="">Todo Chile</option>
                                {% for codigo, nombre in regiones %}
                                    <option value="{{ codigo }}" {% if request.GET.region == codigo %}selected{% endif %}>{{ nombre }}</option>
                                {% endfor %}
                            </select>
                            <div class="d-grid"><button type="submit" class="btn btn-primary">Aplicar Filtros</button><a href="/candidatos/" class="btn btn-link text-decoration-none btn-sm mt-2">Limpiar</a></div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-md-9">
                <div class="row">
                    {% for c in candidatos %}
                    <div class="col-md-6 col-lg-4 mb-4">
                        <div class="card h-100 shadow-sm border-0 text-center p-3 hover-card">
                            <div class="card-body">
                                {% if c.foto %}
                                    <img src="{{ c.foto.url }}" class="rounded-circle mb-3 border border-3 border-white shadow-sm" style="width: 100px; height: 100px; object-fit: cover;">
                                {% else %}
                                    <img src="https://ui-avatars.com/api/?name={{ c.nombre }}&size=100&background=random&color=fff" class="rounded-circle mb-3 shadow-sm">
                                {% endif %}
                                <h5 class="fw-bold mb-1 text-truncate">{{ c.nombre }}</h5>
                                <p class="text-primary small mb-2 fw-bold">{{ c.titular }}</p>
                                <div class="mb-3">
                                    <span class="badge bg-light text-dark border">{{ c.get_rubro_display|truncatewords:2 }}</span>
                                    <span class="badge bg-light text-dark border">üìç {{ c.get_region_display }}</span>
                                </div>
                                <p class="text-muted small" style="height: 40px; overflow: hidden;">{{ c.presentacion|truncatewords:8 }}</p>
                                <a href="/candidato/{{ c.id }}/" class="btn btn-outline-primary w-100 stretched-link">Ver Perfil</a>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                        <div class="col-12 text-center py-5"><h4>No se encontraron profesionales.</h4><a href="/publicar-perfil/" class="btn btn-primary">Publicar mi CV</a></div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</body>
</html>